<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>L·ªãch s·ª≠ Pickleball c·ªßa m·∫•y anh em m√¨nh</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      background-color: #f7f9fc;
      color: #333;
    }

    header {
      background: linear-gradient(135deg, #00b4db, #0083b0);
      color: white;
      text-align: center;
      padding: 25px 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    h1 { margin: 0; font-size: 1.8em; }

    /* Tabs */
    .tab-container {
      display: flex;
      justify-content: center;
      background: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      border-bottom: 1px solid #eee;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 15px;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
      font-weight: 600;
    }
    .tab:hover { background: #f0f0f0; }
    .tab.active {
      background: linear-gradient(135deg, #00b4db, #0083b0);
      color: white;
    }

    /* Content sections */
    .content { display: none; padding: 20px; animation: fadeIn 0.5s ease; }
    .content.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Tournament cards */
    .tournament-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 20px;
      margin: 20px auto;
      max-width: 900px;
      overflow-x: auto; /* cu·ªôn ngang khi c·∫ßn */
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
      min-width: 600px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      white-space: nowrap;
    }

    th { background-color: #f2f2f2; }

    .timestamp { font-size: 0.9em; color: #666; }

    /* Gallery */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      padding: 20px;
    }

    .gallery img {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .gallery img:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <header>
    <h1>L·ªãch s·ª≠ Pickleball c·ªßa m·∫•y anh em m√¨nh üèì</h1>
  </header>

  <div class="tab-container">
    <div class="tab active" onclick="showTab('tournaments')">üèÜ Gi·∫£i ƒë·∫•u</div>
    <div class="tab" onclick="showTab('gallery')">üì∏ H√¨nh ·∫£nh</div>
  </div>

  <div id="tournaments" class="content active">
    <div id="tournamentsContainer"></div>
  </div>

  <div id="gallery" class="content">
    <h2 style="text-align:center; margin-top:10px;">üì∏ B·ªô s∆∞u t·∫≠p ·∫£nh Pickleball</h2>
    <div class="gallery" id="galleryContainer">
      <img src="https://images.unsplash.com/photo-1709133596711-9c90c3a2a8c3?q=80&w=800" alt="Pickleball 1">
      <img src="https://images.unsplash.com/photo-1692725874597-4bfbf7c31d07?q=80&w=800" alt="Pickleball 2">
      <img src="https://images.unsplash.com/photo-1675973679615-bc6e83e5f2b1?q=80&w=800" alt="Pickleball 3">
      <img src="https://images.unsplash.com/photo-1690567730791-d828d9318b92?q=80&w=800" alt="Pickleball 4">
    </div>
  </div>

<script>
const SUPABASE_URL = 'https://sugyzhnavjttfmumpacw.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1Z3l6aG5hdmp0dGZtdW1wYWN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4MDc1NTUsImV4cCI6MjA3NTM4MzU1NX0.GQC71AfsKLwvqGu6c0rfDLUq8WmfEVUfrJwQ1Qs5Khs';

async function fetchAllTournaments() {
  const apiUrl = `${SUPABASE_URL}/rest/v1/tournaments?select=*&order=created_at.desc`;
  try {
    const res = await fetch(apiUrl, {
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': `Bearer ${SUPABASE_KEY}`
      }
    });

    if (!res.ok) throw new Error(`L·ªói API: ${res.status}`);
    const tournaments = await res.json();

    const container = document.getElementById('tournamentsContainer');
    if (tournaments.length === 0) {
      container.innerHTML = '<p>Ch∆∞a c√≥ gi·∫£i ƒë·∫•u n√†o ƒë∆∞·ª£c t·∫£i l√™n.</p>';
      return;
    }

    tournaments.forEach(tour => {
      const card = document.createElement('div');
      card.classList.add('tournament-card');

      const title = document.createElement('h2');
      title.textContent = tour.name || 'Gi·∫£i kh√¥ng t√™n';
      card.appendChild(title);

      const time = document.createElement('div');
      time.className = 'timestamp';
      time.textContent = `Ng√†y t·∫°o: ${new Date(tour.created_at).toLocaleString()}`;
      card.appendChild(time);

      const standings = tour.data?.Standings || [];
      const matches = tour.data?.Matches || [];

      if (standings.length > 0) {
        const standingsTable = document.createElement('table');
        standingsTable.innerHTML = `
          <thead>
            <tr>
              <th>T√™n</th>
              <th>X·∫øp h·∫°ng</th>
              <th>Th·∫Øng</th>
              <th>Thua</th>
              <th>ƒêi·ªÉm</th>
              <th>T·ª∑ l·ªá th·∫Øng (%)</th>
            </tr>
          </thead>
          <tbody>
            ${standings.map(p => `
              <tr>
                <td>${p.Name}</td>
                <td>${p.Rank}</td>
                <td>${p.Wins}</td>
                <td>${p.Losses}</td>
                <td>${p.Points}</td>
                <td>${p.WinRate}</td>
              </tr>`).join('')}
          </tbody>`;
        card.innerHTML += '<h3>B·∫£ng x·∫øp h·∫°ng</h3>';
        card.appendChild(standingsTable);
      }

      if (matches.length > 0) {
        const matchesTable = document.createElement('table');
        matchesTable.innerHTML = `
          <thead>
            <tr>
              <th>Tr·∫≠n</th>
              <th>ƒê·ªôi 1</th>
              <th>ƒê·ªôi 2</th>
              <th>T·ª∑ s·ªë</th>
              <th>Ng∆∞·ªùi th·∫Øng</th>
            </tr>
          </thead>
          <tbody>
            ${matches.map(m => `
              <tr>
                <td>${m.MatchNumber}</td>
                <td>${m.Team1Player1} & ${m.Team1Player2}</td>
                <td>${m.Team2Player1} & ${m.Team2Player2}</td>
                <td>${m.Score1} - ${m.Score2}</td>
                <td>${m.Winner}</td>
              </tr>`).join('')}
          </tbody>`;
        card.innerHTML += '<h3>Tr·∫≠n ƒë·∫•u</h3>';
        card.appendChild(matchesTable);
      }

      container.appendChild(card);
    });

  } catch (err) {
    console.error(err);
    document.getElementById('tournamentsContainer').innerHTML =
      `<p style="color:red;">L·ªói t·∫£i d·ªØ li·ªáu: ${err.message}</p>`;
  }
}

function showTab(tabId) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
  document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
  document.getElementById(tabId).classList.add('active');
}

fetchAllTournaments();
</script>
</body>
</html>
