<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>L·ªãch s·ª≠ gi·∫£i Pickleball</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background-color: #fafafa; }
    h1 { text-align: center; color: #222; margin-bottom: 30px; }
    h2 { color: #444; margin-top: 40px; }
    .tournament-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 40px;
    }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    .timestamp { font-size: 0.9em; color: #666; }
  </style>
</head>
<body>
  <h1>L·ªãch s·ª≠ c√°c gi·∫£i Pickleball</h1>
  <div id="tournamentsContainer"></div>

<script>
const SUPABASE_URL = 'https://sugyzhnavjttfmumpacw.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1Z3l6aG5hdmp0dGZtdW1wYWN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4MDc1NTUsImV4cCI6MjA3NTM4MzU1NX0.GQC71AfsKLwvqGu6c0rfDLUq8WmfEVUfrJwQ1Qs5Khs'; // üîë Thay b·∫±ng key th·∫≠t t·ª´ Supabase ‚Üí Project Settings ‚Üí API

async function fetchAllTournaments() {
  const apiUrl = `${SUPABASE_URL}/rest/v1/tournaments?select=*&order=created_at.desc`;
  try {
    const res = await fetch(apiUrl, {
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': `Bearer ${SUPABASE_KEY}`
      }
    });

    if (!res.ok) throw new Error(`L·ªói API: ${res.status}`);
    const tournaments = await res.json();

    const container = document.getElementById('tournamentsContainer');
    if (tournaments.length === 0) {
      container.innerHTML = '<p>Ch∆∞a c√≥ gi·∫£i ƒë·∫•u n√†o ƒë∆∞·ª£c t·∫£i l√™n.</p>';
      return;
    }

    tournaments.forEach(tour => {
      const card = document.createElement('div');
      card.classList.add('tournament-card');

      const title = document.createElement('h2');
      title.textContent = tour.name || 'Gi·∫£i kh√¥ng t√™n';
      card.appendChild(title);

      const time = document.createElement('div');
      time.className = 'timestamp';
      time.textContent = `Ng√†y t·∫°o: ${new Date(tour.created_at).toLocaleString()}`;
      card.appendChild(time);

      const standings = tour.data.Standings || [];
      const matches = tour.data.Matches || [];

      // B·∫£ng x·∫øp h·∫°ng
      if (standings.length > 0) {
        const standingsTable = document.createElement('table');
        standingsTable.innerHTML = `
          <thead>
            <tr>
              <th>T√™n</th>
              <th>X·∫øp h·∫°ng</th>
              <th>Th·∫Øng</th>
              <th>Thua</th>
              <th>ƒêi·ªÉm</th>
              <th>T·ª∑ l·ªá th·∫Øng (%)</th>
            </tr>
          </thead>
          <tbody>
            ${standings.map(p => `
              <tr>
                <td>${p.Name}</td>
                <td>${p.Rank}</td>
                <td>${p.Wins}</td>
                <td>${p.Losses}</td>
                <td>${p.Points}</td>
                <td>${p.WinRate}</td>
              </tr>`).join('')}
          </tbody>
        `;
        card.innerHTML += '<h3>B·∫£ng x·∫øp h·∫°ng</h3>';
        card.appendChild(standingsTable);
      }

      // Danh s√°ch tr·∫≠n ƒë·∫•u
      if (matches.length > 0) {
        const matchesTable = document.createElement('table');
        matchesTable.innerHTML = `
          <thead>
            <tr>
              <th>Tr·∫≠n</th>
              <th>ƒê·ªôi 1</th>
              <th>ƒê·ªôi 2</th>
              <th>T·ª∑ s·ªë</th>
              <th>Ng∆∞·ªùi th·∫Øng</th>
            </tr>
          </thead>
          <tbody>
            ${matches.map(m => `
              <tr>
                <td>${m.MatchNumber}</td>
                <td>${m.Team1Player1} & ${m.Team1Player2}</td>
                <td>${m.Team2Player1} & ${m.Team2Player2}</td>
                <td>${m.Score1} - ${m.Score2}</td>
                <td>${m.Winner}</td>
              </tr>`).join('')}
          </tbody>
        `;
        card.innerHTML += '<h3>Tr·∫≠n ƒë·∫•u</h3>';
        card.appendChild(matchesTable);
      }

      container.appendChild(card);
    });

  } catch (err) {
    console.error(err);
    document.body.innerHTML = `<p style="color:red;">L·ªói t·∫£i d·ªØ li·ªáu: ${err.message}</p>`;
  }
}

fetchAllTournaments();
</script>
</body>
</html>




